Implement the ticket: tasks/backlog/T-0702-search-service-call-ranking-rerank.md

Rules (strict):
- Read and follow AGENTS.md.
- Stay within scope: ONLY modify services/search-service/**.
- You MAY also update docs/RUNBOOK.md and scripts/test.sh if needed.
- Do NOT touch infra/**, contracts/**, db/**, services/query-service/**, or services/ranking-service/**.

Assumptions:
- Local OpenSearch v1.1 is already running (or can be started via ./scripts/local_up.sh).
- Search Service runs on :8080, Ranking Service runs on :8082.
- Ranking Service T-0701 is implemented and exposes POST /rerank.

Goal:
- Upgrade Search Service so that /search performs:
  1) candidate retrieval (lexical + optional vector + RRF)  [existing T-0602 behavior]
  2) call Ranking Service /rerank with candidates + features
  3) return reranked hits (top N) to the client

Required behavior:
1) Keep existing endpoints:
  - GET /health -> { "status": "ok" }
  - POST /search (same request shape)

2) Build rerank request to Ranking Service:
  - URL: http://localhost:8082/rerank (configurable via application.yml)
  - Request:
    {
    "query": { "text": "<query.raw>" },
    "candidates": [
    {
    "doc_id": "...",
    "features": {
    "lex_rank": <int|null>,
    "vec_rank": <int|null>,
    "rrf_score": <double>,
    "issued_year": <int|null>,
    "volume": <int|null>,
    "edition_labels": <string[]|[]>
    }
    }
    ],
    "options": { "size": <options.size> }
    }
  - Pass through x-trace-id / x-request-id headers (use the ones generated/received by Search Service).

3) Candidate generation details:
  - Use existing hybrid retrieval + RRF fusion from T-0602.
  - For each doc_id, compute:
    - lex_rank (1-based) if present
    - vec_rank (1-based) if present
    - rrf_score (the fused score you already compute)
  - Hydrate doc fields from OpenSearch (issued_year, volume, edition_labels) before calling /rerank,
    because Ranking Service needs those features.

4) Ranking call behavior:
  - If Ranking Service call succeeds:
    - Use its returned ordering (hits[].doc_id order) and score if provided.
    - Return final response hits in reranked order.
    - Keep debug info (lex_rank/vec_rank/rrf_score + ranking_score) in response for now.
  - If Ranking Service is down/timeouts/errors:
    - Fallback to existing fused ranking (RRF-only) and return 200.
    - Include a debug flag in response e.g. "ranking_applied": false (or similar) without changing contracts outside
      search-service.

5) Timeouts:
  - Add a tight timeout for the Ranking Service call (e.g., 150~250ms).
  - Do not block overall response too long; keep existing OpenSearch timeouts.

6) Configuration:
  - Add to services/search-service/src/main/resources/application.yml:
    ranking:
    base-url: http://localhost:8082
    timeout-ms: 200
  - Keep opensearch config as-is.

Testing requirements (must pass without external deps):
- Ensure: cd services/search-service && ./gradlew test passes on clean checkout.
- Add mock-based unit tests:
  1) When ranking client returns reranked doc order, SearchController /search returns hits in that order.
  2) When ranking client throws (timeout/unavailable), service falls back to RRF order and still returns 200.
- Do NOT require OpenSearch or Ranking Service running for unit tests.
