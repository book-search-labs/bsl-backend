Implement the ticket: tasks/backlog/T-0602-search-service-hybrid-rrf-mvp.md

Rules:
- Read and follow AGENTS.md.
- Stay within scope: ONLY modify services/search-service/**.
- You MAY also update docs/RUNBOOK.md and scripts/test.sh if needed.
- Do NOT touch infra/**, contracts/**, db/**, or services/query-service/**.

Assumptions:
- Local OpenSearch v1.1 is already running from T-0210:
  - http://localhost:9200
  - aliases exist: books_doc_read, books_vec_read
- Security is disabled for local dev (no auth).

Required behavior:
1) Expose GET /health -> { "status": "ok" }
2) Expose POST /search (Spring Boot, port 8080 by default):
  - Request (MVP):
    {
    "query": { "raw": "<string>" },
    "options": { "size": 10, "from": 0, "enableVector": true, "rrfK": 60 }
    }
  - Extract trace_id/request_id from headers x-trace-id/x-request-id if present; otherwise generate.
3) Implement hybrid retrieval:
  - Lexical: query books_doc_read with multi_match over fields that exist in mapping:
    title_ko, title_en, authors.name_ko, series_name, publisher_name
    Collect topK (default 200) and record lex_rank by doc_id.
  - Vector: query books_vec_read with kNN against embedding (dimension 1024).
    Use a deterministic ToyEmbedder in code: same string -> same 1024-d float vector, stable across runs.
    If vector fails or times out, continue with lexical-only (fallback).
4) Fusion:
  - Merge candidates by doc_id using RRF:
    score = sum( 1 / (k + rank_i) ), default k=60.
  - Sort by score desc, take top N (options.size).
  - Include debug ranks (lex_rank, vec_rank) in response for now.
5) Hydration:
  - For the final doc_ids, fetch display fields from books_doc_read using _mget.
  - Return hit.source with at least:
    title_ko, authors (flatten to string list if nested), publisher_name, issued_year, volume, edition_labels
6) Error handling:
  - If request.query.raw is missing/empty -> 400 with a clear JSON error body.
  - If OpenSearch is down -> 503 with a clear JSON error body.

Testing requirements:
- Add tests so `cd services/search-service && ./gradlew test` passes.
- Prefer mock-based unit tests for the gateway/service; do not require OpenSearch running for unit tests.
- If you add any optional integration test, guard it with an env flag so CI/local doesn’t fail when OS is down.

Validation (run and report results):
1) Ensure OpenSearch is up:
   ./scripts/local_up.sh
2) Start the Search Service:
   cd services/search-service && ./gradlew bootRun
3) Call:
   curl -s -XPOST "http://localhost:8080/search" \
   -H "Content-Type: application/json" \
   -d '{"query":{"raw":"해리"},"options":{"enableVector":true,"size":5}}'
   Expect: hits.length >= 1 and hit.source.title_ko is present.
4) Run tests:
   cd services/search-service && ./gradlew test

Implementation notes:
- Keep code small and readable. Create a thin OpenSearchGateway that uses Spring WebClient or RestTemplate.
- Use timeouts for OpenSearch calls (e.g., 100~200ms) and trigger fallback on timeout for vector stage.
- Do not change existing contracts; keep DTOs local to search-service for now.
