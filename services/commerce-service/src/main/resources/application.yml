server:
  port: ${COMMERCE_PORT:8091}

spring:
  application:
    name: commerce-service
  datasource:
    url: ${DB_URL:jdbc:mysql://localhost:3306/bsl}
    username: ${DB_USER:bsl}
    password: ${DB_PASSWORD:bsl}
    driver-class-name: com.mysql.cj.jdbc.Driver

commerce:
  cart:
    max-qty-per-item: ${CART_MAX_QTY_PER_ITEM:20}
    max-distinct-items: ${CART_MAX_DISTINCT_ITEMS:200}
    free-shipping-threshold: ${CART_FREE_SHIPPING_THRESHOLD:20000}
    bonus-point-threshold: ${CART_BONUS_POINT_THRESHOLD:50000}
    base-shipping-fee: ${CART_BASE_SHIPPING_FEE:3000}
    fast-shipping-fee: ${CART_FAST_SHIPPING_FEE:5000}
  inventory:
    default-seller-id: ${INVENTORY_DEFAULT_SELLER_ID:1}
  loyalty:
    earn-rate-percent: ${LOYALTY_EARN_RATE_PERCENT:5}

payments:
  default-provider: ${PAYMENTS_DEFAULT_PROVIDER:MOCK}
  default-return-url: ${PAYMENTS_DEFAULT_RETURN_URL:http://localhost:5174/payment/result}
  default-webhook-url: ${PAYMENTS_DEFAULT_WEBHOOK_URL:http://localhost:8091/api/v1/payments/webhook/mock}
  mock-checkout-base-url: ${PAYMENTS_MOCK_CHECKOUT_BASE_URL:http://localhost:8090/checkout}
  session-ttl-seconds: ${PAYMENTS_SESSION_TTL_SECONDS:1800}
  mock-webhook-secret: ${PAYMENTS_MOCK_WEBHOOK_SECRET:dev_mock_webhook_secret}
  local-sim-webhook-secret: ${PAYMENTS_LOCAL_SIM_WEBHOOK_SECRET:dev_local_sim_webhook_secret}
  pg-fee-rate-percent: ${PAYMENTS_PG_FEE_RATE_PERCENT:3.0}
  platform-fee-rate-percent: ${PAYMENTS_PLATFORM_FEE_RATE_PERCENT:10.0}
  webhook-retry-enabled: ${PAYMENTS_WEBHOOK_RETRY_ENABLED:true}
  webhook-retry-delay-ms: ${PAYMENTS_WEBHOOK_RETRY_DELAY_MS:30000}
  webhook-retry-initial-delay-ms: ${PAYMENTS_WEBHOOK_RETRY_INITIAL_DELAY_MS:20000}
  webhook-retry-batch-size: ${PAYMENTS_WEBHOOK_RETRY_BATCH_SIZE:20}
  webhook-retry-max-attempts: ${PAYMENTS_WEBHOOK_RETRY_MAX_ATTEMPTS:3}
  webhook-retry-backoff-seconds: ${PAYMENTS_WEBHOOK_RETRY_BACKOFF_SECONDS:30}

app:
  cors:
    allowed-origins: ${CORS_ALLOW_ORIGINS:http://localhost:4173,http://localhost:5173,http://localhost:5174}
    allowed-methods: ${CORS_ALLOW_METHODS:GET,POST,PUT,PATCH,DELETE,OPTIONS}
    allowed-headers: ${CORS_ALLOW_HEADERS:*}
    exposed-headers: ${CORS_EXPOSED_HEADERS:x-trace-id,x-request-id,traceparent}
    allow-credentials: ${CORS_ALLOW_CREDENTIALS:true}

security:
  headers:
    enabled: ${SECURITY_HEADERS_ENABLED:true}
    frame-options: ${SECURITY_FRAME_OPTIONS:DENY}
    referrer-policy: ${SECURITY_REFERRER_POLICY:no-referrer}
    permissions-policy: ${SECURITY_PERMISSIONS_POLICY:geolocation=(), microphone=(), camera=()}
    cross-origin-opener-policy: ${SECURITY_COOP:same-origin}
    cross-origin-resource-policy: ${SECURITY_CORP:same-site}
    hsts-enabled: ${SECURITY_HSTS_ENABLED:false}
    hsts-max-age: ${SECURITY_HSTS_MAX_AGE:31536000}
  csrf:
    enabled: ${SECURITY_CSRF_ENABLED:true}
    allowed-origins: ${SECURITY_CSRF_ALLOWED_ORIGINS:${CORS_ALLOW_ORIGINS:http://localhost:4173,http://localhost:5173,http://localhost:5174}}

management:
  endpoints:
    web:
      exposure:
        include: health,info,prometheus
  endpoint:
    health:
      probes:
        enabled: true
  metrics:
    tags:
      application: ${spring.application.name}
    distribution:
      percentiles-histogram:
        http.server.requests: true
      percentiles:
        http.server.requests: 0.95,0.99
  tracing:
    sampling:
      probability: ${TRACE_SAMPLE_PROBABILITY:1.0}
  otlp:
    tracing:
      endpoint: ${OTEL_EXPORTER_OTLP_ENDPOINT:http://localhost:4318/v1/traces}

logging:
  level:
    root: ${LOG_LEVEL:INFO}
